#include <iostream>
#include <vector>    //std::vector
#include "base64/base64.h" //base64_decode()

std::vector<unsigned short> convertToByteArray(std::string str);
std::string xorWithKey(std::string data);
// std::string decrypt(std::u16string data);

//g++ -o main main.cpp base64/base64.cpp -I base64 -I json
int main()
{
    const std::string b64="EG9ZS0cKAxAfDQkcNBYcDgEmCAoMBRFbUUVJR29ZS0cUDhELAgYmGxALCA0YGAAdNBUMGQIcGEdDS1VVYUVZSQgcHxcQCDoJChERNBUcGTofBwoWGUdDSz4kR29ZS0cUBAsKHwALNAkQGBFbUUUiYUVZS0VbIQQOSzIWGQhbR29ZS0VZSSYMBxEQGBFbR29ZS0VZSTYUCgkVSzYVAggcGEdVYUVZS0VbOQAdSzYVChMcGUdVYUVZS0VbJwoWHwALSUlzS0VZS0c7BxAcSzYVChMcGUdVYUVZS0VbLh0WGQEQHghZPAwVDwkQDQBbR29ZS0VZSSABBBcdAhAUSzERHgIKSUlzS0VZS0crDgFZOAkYHQALSUlzS0VZS0dLSyMMBQIQSyccChYNGEdVYUVZS0VbJwoNGEUWDUUqBwwUDhZbR29ZS0VZSVZZJwoMGABbR29ZS0VZSScVHgBZOAkYHQALSUlzS0VZS0dLSyMMBQIQSyccChYNGEdVYUVZS0VbLh0WGQEQHghZPAwVDwkQDQBbR29ZS0VZSSkYGQIcSzYVAggcSW9ZSzhVYUVZSQgcHxcQCDoJBBEQBAsKNAMVBAoLNBYJChIXDgFbUUUiNklzS0VbDwQQBxwmBgodGEdDSz5zS0VZS0c6HhcKDgFZORAXSUlzS0VZS0c9AhMcGRYcSUlzS0VZS0c1DhERCgkQHxxbYUVZNklzS0VbBgANGQwaNAYYBhUfAhccNAYRBAwaDhZbUUUiNklzS0VbAhYmChYaDgsKAgoXNAgWDwBbUUUfCgkKDklzS0VbBgANGQwaNAwNDggKNBUMGQYRChYcD0dDSz4kR29ZS0cQGDocBQEVDhYKNAgWDwBbUUUfCgkKDklzS0VbBgALCA0YBREmGAAcDzoaBBAXH0dDS1VVYUVZSQMVBAoLNAsMBkdDS1VVYUVZSRAXCAoUBgoXNBccBwwaGEdDSz5zS0VZS0cyHgsYAkdVYUVZS0VbJhAUBgwfAgAdSy0YBQFbR29ZS0VZSSsQBQ8YSzYaGQoVB0dVYUVZS0VbKQoNHwkcD0UtBBcXCgEWSUlzS0VZS0c+GQAUBwwXSy0WGQtbR29ZS0VZSTYQBQIQBQJZKQoOB0dVYUVZS0VbPw0cSyYWHhcQDhdbR29ZS0VZSTQMDhYNAgoXSyYYGQFbR29ZS0VZSTUcChdbR29ZS0VZSScWHxEVDgFZLQkYBgBbR29ZS0VZSSoLBQQUDgsNCglZLQQXSUlzS0VZS0c0ChELEgoKAw4YSUlzS0VZS0c0DhcaHhcASy0WHhceBwQKGEdVYUVZS0VbKQoNHwkcD0U1AgIRHwsQBQJbR29ZS0VZSTYRHhcQAAAXSUlzS0VZS0c7BxAcSyYYBQEVDkdVYUVZS0VbLwodDgYYAwAdGQoXSUlzS0VZS0c1DhENDhdZJBUcBQALSUlzS0VZS0c0BAkNDgtZLgIeS1dbR29ZS0VZSTEWEwwaSyAeDEVLSUlzS0VZS0cpCgsNBAILChURSUlzS0VZS0c/GQoDDgtZLgIeS1dbR29ZS0VZSTYMBQEQCglbR29ZS0VZSTUYGwALSyYLCgscSUlzS0VZS0c0DgQNSwoXSxERDkU7BAscSW9ZSzhVYUVZSRUWGBEmCAoUCQQNSV9ZDQQVGABVYUVZSQYWBgcWSV9ZDQQVGABVYUVZSRccBwwaGEdDSz5zS0VZS0c6HhcKDgFZIAAASUlzS0VZS0c9ChcSGBEWBQBZOwALAgQJH0dVYUVZS0VbLxBUPRBZLwoVB0dzS0UkR29ZS0cLChccNBccBwwaGEdDSz5zS0VZS0c9DgQdSycLCgsaA0dVYUVZS0VbPw0LDgQdSwQXD0U3DgAdBwBbR29ZS0VZSSMWGBYQBwwDDgExDgkQE0dVYUVZS0VbIgYcSyYLDgQUSUlzS0VZS0ctBBcQAkdVYUVZS0VbPwwXDBYRCkdVYUVZS0VbKAQVAhUcGRZbR29ZS0VZSSgYBQIWSUlzS0VZS0c+AhcACkdVYUVZS0VbPAwXDAAdLBccChMcGEdVYUVZS0VbPgsaDgQKAgseSzEWG0dVYUVZS0VbLAwXDAALSUlzS0VZS0ctHhcXAhVbR29ZS0VZSScQGQFZLQQaDgFZPhcXSUlzS0VZS0cpGQQADhdZPA0cDglbR29ZS0VZSSoVD0U6BAwXSUlzS0VZS0c+CggbBwwXDEU6AwwJSUlzS0VZS0ctBBAeA0U7CgsdCgIcGEdVYUVZS0VbOwoaAAANHAQNCA1bR29ZS0VZSTERDkUqGwAaAggcBUdVYUVZS0VbOBEWBQA6CgkcBQEYGUdVYUVZS0VbOA0WHQAVSUlzS0VZS0cwBQYcBRYcSycMGQscGUdVYUVZS0VbJRAXCA0YABBbR29ZS0VZSTUcCgYcSzUQGwBbYUVZNklzS0VbBwAPDgkmBQQUDkdDS0c8EwoLDwwMBkdVYUVZSQgcHxcQCDoaCggJDQwLDjoLDhYNDgFbUUVJR29ZS0cUCh0mBBcbGEdDS1RVYUVZSQcWGBZbUUVbIwABCgIRBBYNSUlzS0VbGAAcD0dDS0hBWVNPX1JNXlxKUlVIWFBIU1JVYUVZSQgcHxcQCDoaHhcLDgsNNA0JNBUcGTofBwoWGUdDSz4kR29ZS0caHhcLDgsNNA0cCgkNA0dDS1JJR29ZS0caBAgUBAsmGQAVAgYKSV9ZMG9ZS0VZSS0YGxUASyMVBBIcGUdVYUVZS0VbOBELChIbDhcLEkdVYUVZS0VbJgQOKQQXAEdVYUVZS0VbOwoNAgoXSyccBxFbR29ZS0VZSScWBBFbR29ZS0VZSScYDEUWDUUpGQAJChcYHwwWBUdVYUVZS0VbPQQTGQRbR29ZS0VZSTccDAQVSzUQBwkWHEdVYUVZS0VbPA0cHxYNBAscSUlzS0VZS0cuChdZOwQQBRFbR29ZS0VZSTUcBUU3AgdbR29ZS0VZSTULDhYcGRMcDywXGAAaH0dVYUVZS0VbKgsaAwoLSUlzS0VZS0c4BQYQDgsNSzEcCkUqDhFbR29ZS0VZSTYUAgkQBQJZJgQKAEdVYUVZS0VbJAEdBxxZOAgWBBERSzYNBAscSUlzS0VZS0c9GQAYBkU6ChEaAwALSUlzS0VZS0c6DgsNDgsXAgQVSzUMER8VDkdVYUVZS0VbJBcQCA0YBwYMBkdVYUVZS0VbJwQXHwALBUdVYUVZS0VbIRADHkU7GQQaDgkcH0dVYUVZS0VbPwwXEkU6AwAKH0dVYUVZS0VbKhcNSwofSzIYGUdVYUVZS0VbJAgYBgoLAkdVYUVZS0VbKQkWBAFZPQwYB0dVYUVZS0VbKRcWBR8cSzYaCgkcGEdVYUVZS0VbOAsYAABZOA4MBwlbR29ZS0VZSScYDEUWDUU0ChcbBwAKSW9ZSzhVYUVZSQgWBRYNDhcKNA4QBwkcD0dDS1VVYUVZSQIWBwFbUUVAUklzS0VbBQAWHDobBAsMGEdDS0dbR29ZS0caChcdNBcYBQEWBjoKDgAdNAYWHgsNSV9ZW0lzS0VbCAQLDzoKDgAdNAYWHgsNSV9ZW0lzS0VbAhYmDwQQBxxbUUUNGRAcR29ZS0cUDhELAgYmCAQUGwMQGQAmGQwNHgQVGEdDS1VVYUVZSQgcHxcQCDoaChcdNAYRBAwaDhZbUUUiNklzS0VbBgANGQwaNBUWHwwWBRYmBAcNCgwXDgFbUUUiNklzS0VbAhYmDQwXCgkmCgYNNAoXSV9ZDQQVGABVYUVZSRELDgQKHhccNBYcDgEmCAoMBRFbUUVJR29ZS0cUDhELAgYmDhMcBREmCA0WAgYcGEdDSz4kR29ZS0caHhcLDgsNNBcWBAhbUUVbCAoURQgcDAQaGQwNRQYYGQEaGQQOB0sXDgoORSscBBIrBAoUSUlzS0VbAwQKNAAUDhcYBwEmAAAASV9ZDQQVGABVYUVZSQcWGBYmGQAVAgYKSV9ZMG9ZS0VZSTYXDgYSBEU8EgBbR29ZS0VZSTcQBQJZBANZHw0cSzYcGRUcBRFbR29ZS0VZSS0WHQALAgseIAwNDkdVYUVZS0VbORAXAgZZLwoUDkdVYUVZS0VbOw0QBwoKBBURDhclHlVJWVIKSzYNBAscSUlzS0VZS0c2GRccGRxbR29ZS0VZSSANDhcXCglZLQAYHw0cGUdVYUVZS0VbJwwDChcdSzEYAglbR29ZS0VZSSYWDQMcDkU9GQwJGwALSUlzS0VZS0ctAgsASy0WHhYcSUlzS0VZS0crHgsQCEUpEhcYBgwdSUlzS0VZS0cqBB8MSUlzS0VZS0c7HhYNDgFZKBcWHAtbR29ZS0VZSTIRAhEcSyccChYNSzYNChEMDkdVYUVZS0VbKhYNGQoVCgccSUlzS0VZS0c8CBEWGwkYGAhbR29ZS0VZSTMcBxMcH0U6AwoSDhdbR29ZS0VZSSYYBwkQBQJZKQAVB0dVYUVZS0VbOwQXDwoLCjkMW1VLXBZZKQoBSUlzS0VZS0c7BwQaAEUqHwQLSUlzS0VZS0c8BhUNEkU6CgIcSUlzS0VZS0cuGQwKHycVCgEcSUlzS0VZS0c/HhYQBAtZIwQUBgALSW9ZSzhVYUVZSQcVHgBbUUVJR29ZS0cJChERNBxbUUUiNklzS0VbGwQNAzoBSV9ZMDhVYUVZSQgcHxcQCDoQHwAUNBUMGQYRChYcNAMVBAoLGEdDSz4kR29ZS0ceBAkdNAIYAgscD0dDS1VVYUVZSQQKCAAXGAwWBToVDhMcB0dDS1VVYUVZSQoXDjoNAggcNAAPDgsNNAkQGBFbUUUiYUVZS0VbKgYaHhcKDgFZKQkYCA4KBgwNA0dVYUVZS0VbKQoXDQwLDkU8BwAUDgsNCgkKSUlzS0VZS0c9DhYQDAscGUdVYUVZS0VbLxAJBwwaChEWGUdVYUVZS0VbLQQaDjELCgEcGUdVYUVZS0VbLQoMBREYAgtZBANZKAkcCgsKAgseSUlzS0VZS0cyBQoOAgseSzYSHgkVSUlzS0VZS0c1CgdbR29ZS0VZSSslHlVJWVIVBBERSUlzS0VZS0cqDgYLDhEpBBcNCglbR29ZS0VZSTERDkUzBBAKH0dVYUVZS0VbPAA0DgANKgIYAgtbR29ZS0VZSTERDkUuBAgYBUUQBUU7BxAcSW9ZSzhVYUVZSQYYGQEmGQQXDwoUNBYcDgEmGQQXDwoUAh8cGUdDS1BVYUVZSQgcHxcQCDoaCggJDQwLDjoUDgEQHwQNDhZbUUVJR29ZS0cJDhcfDgYNSV9ZW0lzS0VbBhAeDAAdSV9ZDQQVGABVYUVZSQgcHxcQCDobHgwVDzoPDhcKAgoXSV9ZSVdJWlxUW1RUWVZbR29ZS0ccHQAXHzoVAhYNSV9ZMG9ZS0VZSScQDEU/AhYRSUlzS0VZS0ctAwBZKAkcGQwaSUlzS0VZS0c9DgQdSyQdHQAXHxALDhdbR29ZS0VZSSIWBwEcBUUwDwoVSUlzS0VZS0c+BAkdDgtZPAwXDEdVYUVZS0VbPAoLBwFZBANZLAoWG0dVYUVZS0VbJwwYGRZZLAQUDkdVYUVZS0VbJwwPAgseSzIYBwlbR29ZS0VZSSgMGA0LBAoUGEdVYUVZS0VbOAYLChVZJAoDDkdVYUVZS0VbOA0QBQwXDEU1AgIRH0dzS0UkR29ZS0ccBwwNDjoUBAsKHwALNAkQGBFbUUUiYUVZS0VbWEUqDgsNGQwcGEdVYUVZS0VbJwQeChMMBwwXSUlzS0VZS0dKSzYcBRELAgAKSUlzS0VZS0c1CgIYHRAVAgtbR29ZS0VZSVZZOAAXHxcQDhZbR29ZS0VZSSILDggVAgtZJQobSUlzS0VZS0c1CgIYHRAVAgtbR29ZS0VZSSILDggVAgtZJQobSUlzS0VZS0dKSzYcBRELAgAKSUlzS0VZS0c+GQAUBwwXSysWCUdzS0UkR29ZS0cUDhELAgYmGAAcDzoJBwQADgFbUUVbRl1LXVNNXFFMUlZAW1RKXlRBXEdVYUVZSRccD0dDS1FVYUVZSQAVAhEcGFYmAAwVBwAdSV9ZW0lzS0VbGQAVAgYmCAoMBREcGRZbUUUiYUVZS0VUWklzS0VZS0hIR29ZS0VZW29ZSzhVYUVZSQAVAhEcGFcmAAwVBwAdSV9ZW0lzS0VbBgANGQwaNAwNDggKNBUMGQIcDzofBwoWGRZbUUUiNklzS0VbGwoNAgoXNBYcDgEmCAoMBRFbUUVJR29ZS0cbBwweAxEKSV9ZMDhVYUVZSQAVAhEcGFQmAAwVBwAdSV9ZW0lzS0VbBBMcGQ4QBwlbUUUfCgkKDklzS0VbBQAWHDoaBBYNSV9ZSUdVYUVZSQgcHxcQCDofBwoWGToLDgQaAwAdSV9ZW0lzS0VbCA0YBhUQBAsKSV9ZW0lzS0VbGAgWAAAdSV9ZDQQVGABVYUVZSRYJAhcQHzoaBBAXH0dDS1VVYUVZSRYJDgYQCgkmGAAcD0dDS1RBW1RNR29ZS0cJBBEQBAsmCA0YBQYcSV9ZW0lzS0VbGA0WGzoLDgkQCBZbUUUiYUVZS0VbKA0cBgwaCglZM0dVYUVZS0VbJgAUCQALGA0QG0U6ChcdSUlzS0VZS0cqBwwXDEdVYUVZS0VbLwoVBxwKJgwLGQoLSUlzS0VZS0cqHxcYBQIcSzYJBAoXSUlzS0VZS0c/GQoDDgtZLhwcSUlzS0VZS0ctHAwKHwAdLRAXBQAVSUlzS0VZS0c0DgQVPwwaAAANSUlzS0VZS0c2GQQXDAApDgkVDhEKSUlzS0VZS0c1DgAlHlVJWVIKSzIYDQMVDkdVYUVZS0VbPwoASyoLBQwNAwoJHwALSUlzS0VZS0c0DgEQCAQVSy4QH0dVYUVZS0VbKAQMBwELBAtbR29ZS0VZSSYVBAYSHAoLADYWHhMcBQwLSUlzS0VZS0ctBAoVCQoBSUlzS0VZS0cxCgsdLxcQBwlbR29ZS0VZSTERDiQbCgYMGEdzS0UkR29ZS0caHhYNBAgmBgodGEdDSz4kR29ZS0cUDhELAgYmGwQNAzoNCg4cBUdDSz4kR29ZS0cXCggcSV9ZSSgWHxwYAEdVYUVZSQ0YGDoLHgcANA4cEkdDSwMYBxYcR29ZS0cUDhELAgYmGwkYEhEQBgBbUUVJR29ZS0cRChYmGAQJGw0QGQAmAAAASV9ZDQQVGABVYUVZSQwKNBELAgQVSV9ZDQQVGABVYUVZSQgcHxcQCDoUCh0mAxUmGwALNAMVBAoLSV9ZMDhVYUVZSRYYHQAmDwQNDkdDS1RMXlNNUlFJXFZLXlNVYUVZSQYYGQEKSV9ZMG9ZS0VZEG9ZS0VZS0VbHhUeGQQdDhZbUUVJR29ZS0VZS0VbBgwKCEdDS1VVYUVZS0VZS0cQD0dDS0c9DgMcBQEmLEdzS0VZSxhVYUVZS0UCYUVZS0VZS0cMGwILCgEcGEdDS1VVYUVZS0VZS0cUAhYaSV9ZW0lzS0VZS0VZSQwdSV9ZSSEcDQAXDzo+SW9ZS0VZFklzS0VZSx5zS0VZS0VZSRAJDBcYDwAKSV9ZW0lzS0VZS0VZSQgQGAZbUUVJR29ZS0VZS0VbAgFbUUVbLwAfDgsdNCJbYUVZS0UER29ZS0VZEG9ZS0VZS0VbHhUeGQQdDhZbUUVJR29ZS0VZS0VbBgwKCEdDS1VVYUVZS0VZS0cQD0dDS0c9DgMcBQEmLEdzS0VZSxhVYUVZS0UCYUVZS0VZS0cMGwILCgEcGEdDS1VVYUVZS0VZS0cUAhYaSV9ZW0lzS0VZS0VZSQwdSV9ZSSEcDQAXDzo+SW9ZS0VZFklzS0VZSx5zS0VZS0VZSRAJDBcYDwAKSV9ZW0lzS0VZS0VZSQgQGAZbUUVJR29ZS0VZS0VbAgFbUUVbOBELAg4cNCJbYUVZS0UER29ZS0VZEG9ZS0VZS0VbHhUeGQQdDhZbUUVJR29ZS0VZS0VbBgwKCEdDS1VVYUVZS0VZS0cQD0dDS0cqHxcQAAAmLEdzS0VZSxhVYUVZS0UCYUVZS0VZS0cMGwILCgEcGEdDS1VVYUVZS0VZS0cUAhYaSV9ZW0lzS0VZS0VZSQwdSV9ZSTYNGQwSDjo+SW9ZS0VZFklzS0VZSx5zS0VZS0VZSRAJDBcYDwAKSV9ZW0lzS0VZS0VZSQgQGAZbUUVJR29ZS0VZS0VbAgFbUUVbOBELAg4cNCJbYUVZS0UER29ZS0VZEG9ZS0VZS0VbHhUeGQQdDhZbUUVJR29ZS0VZS0VbBgwKCEdDS1VVYUVZS0VZS0cQD0dDS0cqHxcQAAAmLEdzS0VZSxhVYUVZS0UCYUVZS0VZS0cMGwILCgEcGEdDS1VVYUVZS0VZS0cUAhYaSV9ZW0lzS0VZS0VZSQwdSV9ZSTYMGRMQHQoLSW9ZS0VZFklzS0VZSx5zS0VZS0VZSRAJDBcYDwAKSV9ZW0lzS0VZS0VZSQgQGAZbUUVJR29ZS0VZS0VbAgFbUUVbJQAMHxcYBwwDDkdzS0VZSxhzS0UkR29ZS0ccBQEVDhYKNAwXCBccBgAXHxZbUUUiNklzS0VbBgANGQwaNAwNDggKNBUMGQIcD0dDSz4kR29ZS0cJHhceDiYWGBFbUUVOXklzS0VbGQoWBjoBSV9ZW0lzS0VbCQkQDA0NNAYWHgsNDhcKSV9ZMDhVYUVZSRcWBAgmEkdDS0hIR29ZS0cUDhELAgYmDAoVDzoJDhcmDQkWBBdbUUUiNklzS0VbBgANGQwaNBUWHwwWBRYmDQkWBBcmHhYYDABbUUUiNklzS0VbCQoKGDoVAhYNSV9ZMG9ZS0VZSS0cEwQeAwoKH0dVYUVZS0VbOAkQBgBZKQoKGEdVYUVZS0VbPw0cSyIMChcdAgQXSW9ZSzhVYUVZSQQQNBYcDgEmCAoMBRFbUUVJR29ZS0ccHQAXHzoaAwQXCAAKSV9ZMG9ZS0VZW0tJR29ZS0VZW0tIR29ZS0VZW0tJWElzS0VZS1VXW1dzS0UkR29ZS0cUDhELAgYmCQoKGDoLDgkQCBZbUUUiNklzS0VbGQAVAgYmGAAcDzoaBBAXH0dDS1BVYUVZSQQaHzoXHghbUUVIR29ZS0cUDhELAgYmDwQUCgIcNBEYAAAXSV9ZMDhVYUVZSQILDgAXSV9ZW0lzS0VbBhwKHwALEjoUCgYRAgscSV9ZW0lzS0VbBgANGQwaNAYYBhUfAhccNBAJDBcYDwAdSV9ZW0lzS0VbGwoNAgoXNBYVBBEKSV9ZWElzS0VbCA0WGAAmBQAWHDoLDhIYGQFbUUUfCgkKDklzS0VbDhMcBREmGAAcDzoaBBAXH0dDS1VVYUVZSQgcHxcQCDoLDgkQCBYmBAcNCgwXDgFbUUUiNklzS0VbDwQQBxwmDwQNDkdDS1RBW1RNR29ZS0cWCREYAgscDzoaChcdGEdDSx4ER29ZS0cJBwQANBEQBgBbUUVJR29ZS0cRCgsdNBYQEQBbUUVMR29ZS0cUCh0mAwAYBxERSV9ZXFVVYUVZSQgWBRYNDhcmGAAcDzoaBBAXH0dDS1ZNR29ZS0cJBBEQBAsKSV9ZMG9ZS0VZSTUWHwwWBUUqBwoNSUlzS0VZS0cpBBEQBAtZOAkWH0dVYUVZS0VbOwoNAgoXSzYVBBFbYUVZNm8E";

    std::cout<<xorWithKey(base64_decode(b64));
    

    return 0;
}

//convertit en tableau de code ASCII
std::vector<unsigned short> convertToByteArray(std::string str)
{
    std::vector<unsigned short> res;
    for(int i=0;i<str.length();++i)
        res.push_back((unsigned short)str[i]);
    return res;
}

std::string xorWithKey(std::string data)
{
    std::vector<char> v;
    auto vec1=convertToByteArray(data);
    auto vec2=convertToByteArray("key");
    for(int i=0;i<data.length();++i)
        //bitwise XOR '^'
        v.push_back((char)(vec1[i] ^ vec2[i%3]));
   std::string res(v.begin(),v.end());
   return res;
}